```python
n = int(input())

if n == 0:
    print(-1)

s, g = [], []
for _ in range(n):
    s.append(int(input()))
    g.append(int(input()))

total_width = 0
for i in range(n):
    x = int(input())
    s[i] += x
    g[i] -= x
    total_width += x

if all(abs(s[i] - s[i-1]) <= 1 for i in range(1, n)):
    print(total_width)
    print(*s)
else:
    print(-1)
```