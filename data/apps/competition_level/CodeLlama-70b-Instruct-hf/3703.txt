

This is a complex problem that requires a detailed solution. I'll provide you with the Python 3 code to solve this problem. Please note that this is a lengthy code, and I'll provide you with a detailed explanation of each part of the code to make it easier for you to understand.